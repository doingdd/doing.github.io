---
layout: post
category: 技术
title: 数据库一致性
---

**本文翻译自[wiki: isolation](https://en.wikipedia.org/wiki/Consistency_（database_systems）)**

一致性的意思是任何事务只能在允许的方式下修改数据，所有写入必须经过[约束](https://en.wikipedia.org/wiki/Data_integrity),[级联](https://en.wikipedia.org/wiki/Rollback_(data_management)#Cascading_rollback),[触发](https://en.wikipedia.org/wiki/Database_trigger),或者它们任意组合验证合法才可以生效。它保证不了所有事务都按照程序希望的结果执行(这是应用代码的职责)，仅仅是任何编码错误都不会导致任何违反已定的数据库约束的情况发生。

## 数据库一致性

数据库一致性的定义一直以来有很大歧义，比如：

1.未来发生的事务已定可以看见过去提交的事务的修改的能力

2.数据库的约束不会打破的能力，尤其是事务提交了以后

3.事务中的操作被精准、正确的执行，而且在遵循应用语义的前提下被验证过的能力。

由于这些定义并不完全互斥，正如大多数关系型数据库管理系统设计的那样，这些定义是可以达成“一致性”的。

通俗的理解一致性：首先，事务执行一定会遵循约束，比如外键约束，唯一约束，非空约束；其次，并发执行事务之后，系统仍然是一致的状态，比如执行前的用户总账户金额和执行后的用户总账户金额一致，无论互相执行了多少笔转账；

一致性强调的是，事务执行之前的系统和执行之后的系统是一致，合理的，比如一个str类型的字段，如果想update成int的某个值，这个事务就违反了一致性，会被rollback

而原子性强调的是：不能部分更新，要么全对，要么全错





